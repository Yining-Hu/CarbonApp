<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <title>Opals in Stock</title>
</head>

<body>
    <h1>Opals in Stock</h1>
    <br/>

    <h2 id="opalcount"></h2>
    <br>

    <h2> Mint Opals </h2>
    <form id="mintform">
        <div>
            <label for="mintname">Opal token name</label>
            <input type="text" id="mintname" name="mintname">
        </div>
        <div>
            <label for="initialdata">Metadata</label>
            <input type="text" id="initialdata" name="initialdata">
        </div>
        <div>
            <button type="submit" id="mint" class="btn btn-primary">Submit</button>
        </div>
    </form>
    <br/>

    <h2> Bulk Mint </h2>
    <form id="bmintform">
        <div>
            <label for="mintfile">Upload a csv file:</label>
            <br>
            <input type="file"
                   id="mintfile" name="mintfile"
                   accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <button type="submit" id="bmint" class="btn btn-primary">Upload</button>
        </div>
    </form>
    <br/>

    <h2> Update Opals </h2>
    <form id="updateform">
        <div>
            <label for="updatename">Opal token name</label>
            <input type="text" id="updatename" name="updatename">
        </div>
        <div>
            <label for="newdata">New Metadata</label>
            <input type="text" id="newdata" name="newdata">
        </div>
        <div>
            <button type="submit" id="update" class="btn btn-primary">Submit</button>
        </div>
    </form>
    <br>

    <h2> Bulk Update </h2>
    <form id="bupdateform">
        <div>
            <label for="updatefile">Upload a csv file:</label>
            <br>
            <input type="file"
                   id="updatefile" name="updatefile"
                   accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <button type="submit" id="bupdate" class="btn btn-primary">Upload</button>
        </div>
    </form>
    <br/>

    <h2> Query Opals From Blockchain </h2>
    <form id="queryform">
        <div>
            <label for="queryname">Opal token name</label>
            <input type="text" id="queryname" name="queryname">
        </div>
        <div>
            <p id="queryresult"></p>
        </div>
        <div>
            <button type="submit" id="query" class="btn btn-primary">Submit</button>
        </div>
    </form>
    <br/>

    <h2> Query Opals From Database </h2>
    <form id="dbqueryform">
    <!-- <form id="dbqueryform"> -->
        <div>
            <label for="dbqueryname">Opal token name</label>
            <input type="text" id="dbqueryname" name="dbqueryname">
        </div>
        <div>
            <p id="dbqueryresult"></p>
        </div>
        <div>
            <input type="submit" id="dbquery" class="btn btn-primary" onclick="return send_query();" value="Submit">
        </div>
    </form>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/3.0.0-rc.5/web3.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/papaparse@5.3.1/papaparse.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/keccak256@latest/keccak256.js"></script>
    <script type="text/javascript" src="./utils.js"></script>
    <script type="text/javascript" src="./index.js"></script>
    <script>
        function send_query() {
            event.preventDefault();

            var queryname = document.getElementById("dbqueryname").value;

            $.ajax({
                url: 'ajaxfile.php',
                type: 'POST',
                data: {
                    'dbqueryname': queryname
                },
                cache: false,
                success: function(response) {
                    var parsed = jQuery.parseJSON(response);
                    var metadata = parsed[0].metadata;
                    $('#dbqueryresult').html("Opal details:" + metadata);
                }               
            });
        }
     </script>
</body>
</html>